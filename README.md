# 경기도 내 초중고등학교 급식정보 제공 및 리뷰게시판

Neis의 오픈API를 활용하여
경기도 내 학교들의 급식 정보를 제공하고
해당 급식에 대한 리뷰 게시판 제작

-----
### 사용 기술 스택
- Java (JDK 17)
- SpringBoot 3.3
- SpringBatch
- MariaDB
- JPA

### 사용 오픈 API
- 학교기본정보 https://open.neis.go.kr/hub/schoolInfo
- 급식식단정보 https://open.neis.go.kr/hub/mealServiceDietInfo

## ERD
![SchoolMealERDFinal2](https://github.com/user-attachments/assets/7a1ca916-6477-4a30-98a4-aa12a629c691)

  
## 프로젝트 기능 및 설계 

### 1. 회원가입/수정/탈퇴 & 로그인

- [회원가입]
  - 핸드폰 번호
    - 동일 핸드폰번호 중복회원가입 불가
  - 이메일
    - 동일 이메일 중복회원가입 불가
  - 비밀번호
    - 암호화 (JWT)
  - 닉네임
    - 이미 존재하는 닉네임으로는 등록 불가
  - 학교 코드
    - (학교코드를 모른다면) 학교명 입력 후 학교코드를 반환받는 기능 이용
    
- [회원정보 수정]
  - 로그인 된 상태에서 비밀번호 입력으로 본인확인 후 수정 가능
  - 비밀번호 / 닉네임 수정
    - 이미 존재하는 닉네임으로는 수정 불가
    
- [회원 탈퇴]
  - 로그인 된 상태에서 비밀번호 입력으로 본인확인 후 탈퇴 가능
    
- [로그인]
  - 이메일 &  비밀번호 입력

-----

### 2. 학교 정보 확인

- [학교정보 저장]
  - API로부터 학교코드, 학교명 데이터를 받아 데이터베이스에 저장

- [학교코드 반환]
  - 학교명을 공백없이 입력하면 학교코드를 반환받을 수 있음

-----

### 3. 급식 정보 확인
   
- [급식정보 저장]
  - API로부터 지난달, 이번달, 다음달(총 3달)의 데이터를 받아 데이터베이스에 저장
  - 주기적으로 싱크(매일 오전 10시) 받도록 함
    - Spring Batch 사용 
  - 매월 1일마다, 1개월이 지난 데이터는 삭제됨
    - Spring Batch 사용 
    
- [급식정보 반환] 
  - 특정 학교코드와 특정날짜 입력 후 급식 정보 반환
    - 동일한 이름의 다른 학교가 존재할 수 있기 때문에 학교코드로 검색

- [급식 평균별점 반환]
  - 특정 학교코드와 특정날짜 입력후 해당 급식에 대한 리뷰의 평균 별점을 계산하여 반환

-----

### 4. 급식 리뷰 게시판
로그인된 이용자만 사용 가능

- [게시글]
  - 작성
    - 날짜, 제목, 100자평, 별점, 사진
  - 수정/삭제
    - 해당 글 작성자만 가능
  - 조회
    - 날짜, 작성자 닉네임, 제목, 100자평, 별점, 사진
    - 전체 리뷰 최신순으로 정렬 (페이징 처리)
    - 내가 쓴 리뷰들 최신순 정렬 (페이징 처리)
    - 특정 게시물 조회 
    
- [댓글]
  - 작성
    - 해당 게시물 작성자와 같은 학교 학생일 때만 작성 가능
  - 수정/삭제
    - 해당 댓글 작성자만 가능
  - 조회
    - 댓글 작성자 닉네임, 댓글 내용 표시
    - 작성 날짜순 정렬 (페이징 처리)
    - 공감순 정렬 (페이징 처리)
  - 공감
    - 같은 학교 학생만 사용 가능
    - 같은 댓글에 대한 중복 공감 불가 == 두 번 공감시 공감취소 (토글 방식으로 구현)
    - 동시성 처리를 위해 비관적 락 적용
      
-----

### 5. 불건전한 글/댓글을 작성한 사용자 신고처리 기능
- 하루에 서로 다른 10명에게 신고를 당할 시 이용정지
  - 다음 로그인 시도시 로그인 불가
- 이용정지 일주일 후 자동으로 정지해제
  - 매일 자정마다 이용정지 해제 스케줄러
- 신고자는 신고이유 작성
- 같은 날 중복신고 불가
  - 신고자가 동일 피신고자를 같은 날 신고한 이력이 있는지 확인 후 신고처리
- 이용정지 해제 후 동일인에 대한 재신고 가능
  - 신고자의 신고일이 피신고자의 이용정지종료일 이후인지 확인 후 신고처리

